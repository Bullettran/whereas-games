import{m as d,_ as l,o as i,c as a,a as s,ab as u,ac as n,t as p,q as f,ad as c}from"./Ciub7dEi.js";const h=d({name:"Registration",data(){return{form:{username:"",password:"",isSelectedSpecies:!1,isAdmin:!1},formError:""}},methods:{async createUser(){if(this.formError="",!this.form.username||!this.form.password){this.formError="Заполните все поля";return}if(this.form.password.length<6){this.formError="Пароль должен быть не короче 6 символов";return}try{const{data:e,error:r}=await this.$supabase.auth.signUp({email:`${this.form.username}@mail.ru`,password:this.form.password,options:{data:{username:this.form.username,isSelectedSpecies:this.form.isSelectedSpecies,isAdmin:this.form.isAdmin}}});if(r){r.message.includes("User already registered")?this.formError="Пользователь с таким именем уже существует":this.formError="Ошибка регистрации: "+r.message;return}const o=this.$bootstrap.Modal.getInstance(document.querySelector("#registration"));o&&o.hide(),this.$router.push("/")}catch(e){this.formError="Неизвестная ошибка. Попробуйте позже.",console.error(e)}}}}),_={class:"registration"},g={class:"registration__field"},w={class:"registration__field"},E={key:0,class:"registration__error"};function b(e,r,m,o,y,v){return i(),a("div",_,[r[4]||(r[4]=s("h2",{class:"registration__title"},"Регистрация",-1)),s("form",{enctype:"application/x-www-form-urlencoded",onSubmit:r[2]||(r[2]=c((...t)=>e.createUser&&e.createUser(...t),["prevent"]))},[s("div",g,[u(s("input",{class:"registration__input","onUpdate:modelValue":r[0]||(r[0]=t=>e.form.username=t),type:"text",autocomplete:"off",placeholder:"Имя пользователя"},null,512),[[n,e.form.username]])]),s("div",w,[u(s("input",{class:"registration__input","onUpdate:modelValue":r[1]||(r[1]=t=>e.form.password=t),type:"password",autocomplete:"new-password",placeholder:"Пароль"},null,512),[[n,e.form.password]])]),r[3]||(r[3]=s("div",{class:"registration__buttons"},[s("button",{class:"registration__button button button--metal",type:"submit"},"Создать пользователя")],-1)),e.formError?(i(),a("div",E,p(e.formError),1)):f("",!0)],32)])}const B=l(h,[["render",b],["__scopeId","data-v-29ff7cc6"]]);export{B as default};
