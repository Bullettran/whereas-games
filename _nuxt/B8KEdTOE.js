import m from"./B8X-v8cW.js";import{u as g}from"./B8PUb6Nc.js";import{s as u}from"./FVqIloQu.js";import{m as d,s as f,p as v,_ as y,c as i,a as o,x as _,q as n,u as l,v as x,o as c}from"./DmsB1YVh.js";import"./AsaAj2Jt.js";const T=d({name:"Index",data:()=>({character:{x:430,y:800,speed:3,facingLeft:!1,previousX:394,moving:!1,moveInterval:null},char:g(),targets:{start:{x:400,y:600},npc:{x:400,y:440,typewriter:!1,text:"Ты пришёл... Хотя никто не звал. Вижу, в твоих глазах ещё теплится надежда — смешно. Эти земли давно забыли, что такое свет. Тени шепчутся за спиной, дороги ведут в никуда, а ворота позади тебя... хм. Они уже исчезли, не так ли? Ладно. Раз уж ты здесь — иди к Старому Алтарю. Может, тогда поймёшь, зачем тебя выбрали.",speed:5},battle:{x:300,y:440},violet:{x:510,y:390}},gameProcess:{act:0}}),methods:{moveTo(e){if(this.character.moving)return;this.character.moving=!0;const t={x:this.targets[e].x,y:this.targets[e].y};clearInterval(this.character.moveInterval),this.character.moveInterval=u(()=>{const a=t.x-this.character.x,r=t.y-this.character.y,s=Math.sqrt(a*a+r*r);if(a<0?this.character.facingLeft=!0:a>0&&(this.character.facingLeft=!1),s<this.character.speed){this.character.x=t.x,this.character.y=t.y,this.character.moving=!1,clearInterval(this.character.moveInterval),e==="npc"?(this.targets.npc.typewriter=!0,setTimeout(()=>{this.$refs.typewriter.startTyping()},300)):e==="violet"&&f("/game/fly-demon");return}this.character.previousX=this.character.x,this.character.x+=a/s*this.character.speed,this.character.y+=r/s*this.character.speed},16)},onEndDialog(){this.targets.npc.typewriter=!1,this.moveTo("battle");const e=document.querySelector(".game__container");e&&e.classList.add("container--shake"),setTimeout(()=>{this.gameProcess.act=1},3e3)}},mounted(){setTimeout(()=>{this.moveTo("start")},1e3)}}),$=v("/images/sprites/npc/npc-start.png"),k={class:"game"};function I(e,t,a,r,s,w){const p=m;return c(),i("div",k,[o("div",{class:l([e.gameProcess.act===0?"game__container":"game__container--1"])},[e.gameProcess.act===0?(c(),i("div",{key:0,class:"game__npc game__npc--start",onClick:t[0]||(t[0]=h=>e.moveTo("npc"))},[t[2]||(t[2]=o("img",{class:"game__plug",src:$,alt:"Первый нпс"},null,-1)),e.targets.npc.typewriter?(c(),_(p,{key:0,onNext:e.onEndDialog,speed:e.targets.npc.speed,ref:"typewriter",class:"game__typewriter game__typewriter--npc",text:e.targets.npc.text},null,8,["onNext","speed","text"])):n("",!0)])):n("",!0),e.gameProcess.act===1?(c(),i("div",{key:1,onClick:t[1]||(t[1]=h=>e.moveTo("violet")),class:"game__portal game__portal--violet"})):n("",!0),o("div",{class:l([e.character.moving?`${e.char.character.species}--run`:`${e.char.character.species}--idle`,e.character.facingLeft?`${e.char.character.species}--left`:"",`${e.char.character.species?e.char.character.species:"arcanist"}`,"game__person"]),ref:"character",style:x({left:e.character.x+"px",top:e.character.y+"px"})},null,6)],2)])}const N=y(T,[["render",I],["__scopeId","data-v-eb2a9785"]]);export{N as default};
